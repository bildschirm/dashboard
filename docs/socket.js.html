<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: socket.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: socket.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * The socket module handles all communiations with Bildschirm.
 *
 * @module @socket
 * @see https://mateffy.me/mission-control-client
 * @requires mission-control-client
 */
import config from '@config';
import store from './store';
import { MissionControlClient, SOCKET_ERROR } from 'mission-control-client';

const client = new MissionControlClient(
	config.socketUrl,
	'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoibWF0In0sImlhdCI6MTU1ODUxNDAzNywiZXhwIjoxNTU4NjAwNDM3LCJhdWQiOiJob21lLm1hdGVmZnkubWUiLCJpc3MiOiJzc28uaG9tZS5tYXRlZmZ5Lm1lIn0.9Uk3TJrKs_jCr0-xZhpGnL3H-BzWS9BzjMtDHzhbLyk'
);

store.commit('setConnectionStatus', 'connecting');

client.on('connect', () => {
	store.commit('setConnectionStatus', 'connected');
	console.log('Connected to Bildschirm.');
});

client.on('reconnecting', () => {
	store.commit('setConnectionStatus', 'connecting');
});

client.on('disconnect', reason => {
	console.log('Disconnected from Bildschirm. Reason:', reason);
	store.commit('setConnectionStatus', 'disconnected');
});

client.on('error', errorType => {
	// if we ran out of reconnection attempts
	if (errorType === SOCKET_ERROR.NO_ATTEMPTS_LEFT) {
		store.commit('setConnectionStatus', 'disconnected');
	}
});

client.on('initial-state', data => {
	console.log('Received Initial State:', data);
	store.commit('fullUpdateMcState', data.state);
});

client.subscribe('update', data => {
	console.log('State Update:', data);
	store.commit('updateMcState', data.state);
});

export default {
	invokeAction(action, data) {
		console.log(`Calling action: ${action} with data:`, data);
		client.action(action, data);
	}
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-@config.html">@config</a></li><li><a href="module-@socket.html">@socket</a></li><li><a href="module-store.html">store</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Thu May 23 2019 19:08:29 GMT+1000 (Australian Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
